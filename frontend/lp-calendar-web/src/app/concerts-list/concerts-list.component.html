<h2>List of concerts</h2>

<!-- Modal -->
<ng-template #addConcertContent let-addConcertModal>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="addConcertModalLabel">Add new concert</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form #form="ngForm" [formGroup]="addConcertForm" class="form">
          <div class="card mt-3">
            <div class="card-body">
              <!-- Date -->
              <div class="form-group">
                <label for="postedStartTime">Start time (according to ticket vendor)</label>
                <input id="postedStartTime" type="datetime-local" formControlName="postedStartTime" class="form-control"
                       [ngClass]="{ 'is-invalid': addConcertForm.controls.postedStartTime.invalid }">
                <div *ngIf="addConcertForm.controls.postedStartTime.invalid" class="text-danger">
                  <small *ngIf="addConcertForm.controls.postedStartTime.errors">Start time is required.</small>
                </div>
              </div>
              <!-- Venue -->
              <div class="form-group">
                <label for="venue">Venue Name</label>
                <input id="venue" type="text" formControlName="venue" class="form-control"
                       [ngClass]="{ 'is-invalid': addConcertForm.controls.venue.invalid }">
                <div *ngIf="addConcertForm.controls.venue.invalid" class="text-danger">
                  <small *ngIf="addConcertForm.controls.venue.errors">Venue name is required.</small>
                </div>
              </div>
              <!-- City -->
              <div class="form-group">
                <label for="city">City</label>
                <input id="city" type="text" formControlName="city" class="form-control"
                       [ngClass]="{ 'is-invalid': addConcertForm.controls.city.invalid }">
                <div *ngIf="addConcertForm.controls.city.invalid" class="text-danger">
                  <small *ngIf="addConcertForm.controls.city.errors">City is required.</small>
                </div>
              </div>
              <!-- State -->
              <div class="form-group">
                <label for="state">State (optional)</label>
                <input id="state" type="text" formControlName="state" class="form-control"
                       [ngClass]="{ 'is-invalid': addConcertForm.controls.state.invalid }">
                <div *ngIf="addConcertForm.controls.state.invalid" class="text-danger">
                  <small *ngIf="addConcertForm.controls.state.errors">State is invalid.</small>
                </div>
              </div>
              <!-- Country -->
              <div class="form-group">
                <label for="country">Country</label>
                <input id="country" type="text" formControlName="country" class="form-control"
                       [ngClass]="{ 'is-invalid': addConcertForm.controls.country.invalid }">
                <div *ngIf="addConcertForm.controls.country.invalid" class="text-danger">
                  <small *ngIf="addConcertForm.controls.country.errors">Country is required.</small>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" [disabled]="addConcertFormSaving$">Close</button>
        <button type="button" class="btn btn-success" id="createFormSubmitBtn" (click)="onCreateFormSubmit()" [disabled]="!addConcertForm.valid || addConcertFormSaving$">
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" [hidden]="!addConcertFormSaving$"></span>
          <span class="sr-only">{{ addConcertFormSaving$ ? "Adding..." : "Add" }}</span>
        </button>
      </div>
    </div>
  </div>
</ng-template>

<!-- Button to add concert -->
<button type="button" class="btn btn-outline-primary" (click)="onCreateConcertClicked(addConcertContent)">
  Add concert
</button>

<!-- List of all concerts -->
<table class="table table-striped align-middle">
  <thead>
  <tr>
    <th scope="col">Date</th>
    <th scope="col">Location</th>
  </tr>
  </thead>
  <tbody class="table-group-divider">
  <tr *ngFor="let concert of concerts$">
    <td>
      {{ concert.postedStartTime |  date: 'short' }}
      <!-- TODO: different timezones? -->
    </td>
    <td>
      <b>{{ concert.venue }}</b>
      <br/>
      <small>{{ concert.city }}, {{ concert.state }}, {{ concert.country }}</small>
    </td>
  </tr>
  </tbody>
</table>
